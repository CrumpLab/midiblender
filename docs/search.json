[{"path":"https://crumplab.com/midiblender/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 midiblender authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"importing-mangling-exporting","dir":"Articles","previous_headings":"","what":"Importing, Mangling, Exporting","title":"Getting started with MIDI mangling in R","text":"workflow : Import midi file R data.frame Mangle MIDI R Construct new valid midi file, export (even play fluidsynth immediate gratification) import export mostly calls pyramidi. mangling part mostly done {midiblender}.","code":""},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"importing","dir":"Articles","previous_headings":"Importing, Mangling, Exporting","what":"Importing","title":"Getting started with MIDI mangling in R","text":"’m relying pyramidi python packages wrapped pyramidi (miditapyr mido) import export MIDI. recommend checking documentation packages. ’s quick example importing MIDI file {midiblender}. midi_to_object() helper function wrap common calls pyramidi. following code chunk shows major steps inside function objects contained midi_objects list, list2env(midi_objects, .GlobalEnv) bumps global environment. lot going inside objects miditapyr mido objects. contain MIDI file information various formats, methods, interfaces python reticulate. importing, important aspect midi_df object produced pyramidi::miditapyr$unnest_midi(). one contains midi file R data.frame! example, top 10 rows. MIDI files can get complicated functions developed simple MIDI files mind. simple MIDI file start rows meta tags define important parameters MIDI file. can grabbed midi_df using dplyr::filter(). problems already notice. First, last row meta message belongs end track, contains “end_of_track” message. message placed correctly end example midi file. filtered rows meta == TRUE, shows . look tail midi_df, last line meta message “end_of_track”. second issue particular midi file meta message setting midi tempo. generated file ableton live, guess ’s feature generate midi files. {midiblender} make copy midi_df, grab meta messages, modify include tempo message (case default 500000 120 BPM). MIDI files contain note_on note_off messages sandwiched header meta messages last end_of_track meta message (can kinds messages ). MIDI represents pitch steps 0-127, note column. velocity controls note volume. midi keyboard, every time key pressed , midi file record “note_on” message. key released, “note_off” message recorded. times time column. time column represents messages relative time last message. first three messages data frame 0 time, means get played first. 16 midi ticks later, first “note_off” message occurs. followed simultaneously two messages, simultaneous happen 0 time elapsing relative last time stamp. components place mangling can begin. long mangled results get back MIDI format, result playable.","code":"midi_objects <- midi_to_object(\"all_overworld.mid\") list2env(midi_objects, .GlobalEnv) # add to global environment #> <environment: R_GlobalEnv> #import midi using miditapyr miditapyr_object <- pyramidi::miditapyr$MidiFrames(file_path)  #import using mido mido_object <- pyramidi::mido$MidiFile(file_path)  # to R dataframe message_list_df <- pyramidi::miditapyr$frame_midi(mido_object) ticks_per_beat <- mido_object$ticks_per_beat  # unnest the dataframe midi_df <- pyramidi::miditapyr$unnest_midi(message_list_df) knitr::kable(midi_df[1:10,]) meta_tags <- midi_df %>%   dplyr::filter(meta == TRUE)  knitr::kable(meta_tags) knitr::kable(tail(midi_df)) copy_midi_df <- midiblender::copy_midi_df_track(midi_df, track =0) meta_midi_df <- midiblender::get_midi_meta_df(copy_midi_df) meta_midi_df <- midiblender:::set_midi_tempo_meta(meta_midi_df)  knitr::kable(meta_midi_df) note_messages <- midi_df %>%   dplyr::filter(type %in% c(\"note_on\",\"note_off\") == TRUE)  knitr::kable(head(note_messages))"},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"mangling","dir":"Articles","previous_headings":"","what":"Mangling","title":"Getting started with MIDI mangling in R","text":"’ll keep mangling example simple . vignettes show complicated generative stuff transformations involving matrix representations. Let’s use R tricks randomize pitch midi file. ’d like randomly assign new note pitch values existing ones. ’s example R fun. takes whole column note values, randomly shuffles using sample(), puts back . Great, MIDI mangled. , good mangly way. example, code keep track pairs note messages. means notes may “note_on” messages don’t get turned , get turned long delay. introduces random sustains changed notes. Anyway, additional considerations needed keep tight. aside, far haven’t developed much way compositional methods, check pyramidi documentation direction. vignettes, get bunch mangling involves converting midi matrix representations back. leads opportunities probabilistic sequence generation related things.","code":"note_messages$note <- sample(note_messages$note)"},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"exporting","dir":"Articles","previous_headings":"","what":"Exporting","title":"Getting started with MIDI mangling in R","text":"point good go exporting. main requirements reconstitute midi_df data frame meta headers, modified body containing note messages changed, end end_of_track message. point new_midi_df valid MIDI structured R data.frame. next step update miditapyr_object using following method.","code":"# split the meta messages into header and end, return a list with each part meta_df_split <- midiblender::split_meta_df(meta_midi_df)  # added a tempo column to the meta_midi_df earlier,  # need to add it to the note_messages df note_messages <- note_messages %>%   dplyr::mutate(tempo = NaN)  # bind it all together new_midi_df <- rbind(meta_df_split[[1]],                      note_messages,                      meta_df_split[[2]]) # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)"},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"write-midi-to-file","dir":"Articles","previous_headings":"Exporting","what":"Write midi to file","title":"Getting started with MIDI mangling in R","text":"miditapyr_object now updated new MIDI info. object write file method export contents file. works, mangled, yet somehow still recognizable mario music.","code":"#write midi file to disk miditapyr_object$write_file(\"rando_mario.mid\")"},{"path":"https://crumplab.com/midiblender/articles/Getting_started.html","id":"bouncing-to-mp3-with-fluid-synth","dir":"Articles","previous_headings":"Exporting","what":"bouncing to mp3 with fluid synth","title":"Getting started with MIDI mangling in R","text":"’s possible use fluid synth record midi file audio format. won’t say much , ’s example code. ’m using av package convert wav mp3.","code":"######### # bounce to mp3 with fluid synth  track_name <- \"rando_mario\"  wav_name <- paste0(track_name,\".wav\") midi_name <- paste0(track_name,\".mid\") mp3_name <- paste0(track_name,\".mp3\")  # synthesize midi file to wav with fluid synth system_command <- glue::glue('fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/nintendo_soundfont.sf2 {midi_name}') system(system_command)  # convert wav to mp3 av::av_audio_convert(wav_name,mp3_name)  # clean up and delete wav if(file.exists(wav_name)){   file.remove(wav_name) }"},{"path":[]},{"path":[]},{"path":"https://crumplab.com/midiblender/articles/composition_tests.html","id":"reshaping-global-probabilities","dir":"Articles","previous_headings":"","what":"reshaping global probabilities","title":"composition_tests","text":"","code":"#import midi mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) # send objects to global environment track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  # convert to a piano roll matrix all_midi <- midi_df_to_matrix(midi_df,track=0)  # reshape to desired interval music_matrix <- reshape_piano_roll(all_midi,48*2)  # probabilistic sampling  # create conditional vector conditional_vector <- rep(0,dim(music_matrix)[2]) conditional_vector[(c(50,66,76)+1)] <- 1  dot_products <- conditional_vector %*% t(music_matrix) positive_similarity <- which(dot_products > 0)   feature_probs <- get_feature_probs(midi_matrix = music_matrix[positive_similarity,])  mean_note_density <- get_mean_note_density(midi_matrix = music_matrix[positive_similarity,])  new_features <- new_features_from_probs(probs = feature_probs,                                         density = mean_note_density,                                         examples = 1) # loop new_feature_vectors <- new_features  for(i in 1:40) {   # put second half into conditional vector   conditional_vector <- c(new_features[((length(new_features)/2)+1):length(new_features)],                           rep(0,length(new_features)/2))   dot_products <- conditional_vector %*% t(music_matrix)   positive_similarity <- which(dot_products > 0)      if(length(positive_similarity) == 0){     # sample some random stuff     positive_similarity <- sample(1:dim(music_matrix)[1],25)     print(i)   }         feature_probs <-     get_feature_probs(midi_matrix = music_matrix[positive_similarity, ])      mean_note_density <-     get_mean_note_density(midi_matrix = music_matrix[positive_similarity, ])      new_features <- new_features_from_probs(probs = feature_probs,                                           density = mean_note_density,                                           examples = 1)   new_feature_vectors <- rbind(new_feature_vectors,new_features) }  new_matrix <- feature_vector_to_matrix(vec = new_feature_vectors,                                        num_notes = 128)  # transform back to midi midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 1,                                     note_off_length = 8)  meta_messages_df <- get_midi_meta_df(track_0)  meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 600000)  split_meta_messages_df <- split_meta_df(meta_messages_df)  new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 64)  #### bounce  # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"try_write.mid\")"},{"path":"https://crumplab.com/midiblender/articles/composition_tests.html","id":"global-probabilities","dir":"Articles","previous_headings":"","what":"global probabilities","title":"composition_tests","text":"","code":"# load a midi file mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) # send objects to global environment  # copy a particular track for processing track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  # separate copy to extend with additional timing information copy_track <- copy_and_extend_midi_df(midi_df = midi_df,                                       track_num = 0)  # get timing information metric_tibble <- make_metric_tibble(copy_track, bars = 48, smallest_tick = 8,ticks_per_beat = 96)  # add timing to copy copy_track <- add_bars_to_copy_df(copy_track, metric_tibble)  # convert to a matrix, each row is a bar. music_matrix <- create_midi_matrix(   df = copy_track,   num_notes = 128,   intervals_per_bar = 48,   separate = TRUE )  # probabilistic sampling feature_probs <- get_feature_probs(midi_matrix = music_matrix$pitch_by_time_matrix)  mean_note_density <- get_mean_note_density(midi_matrix = music_matrix$pitch_by_time_matrix)  new_features <- new_features_from_probs(probs = feature_probs,                                         density = mean_note_density,                                         examples = 10)  new_matrix <- feature_vector_to_matrix(vec = new_features,                                        num_notes = 128)  #### transform for export  midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 8,                                     note_off_length = 32)  meta_messages_df <- get_midi_meta_df(track_0)  meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 500000)  split_meta_messages_df <- split_meta_df(meta_messages_df)  new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 64)  #### bounce  # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"try_write.mid\")"},{"path":"https://crumplab.com/midiblender/articles/composition_tests.html","id":"try-canon-in-d","dir":"Articles","previous_headings":"","what":"try canon in D","title":"composition_tests","text":"","code":"library(midiblender) #import midi mario <- midi_to_object(\"canon.mid\") list2env(mario, .GlobalEnv) # send objects to global environment track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  # convert to a piano roll matrix all_midi <- midi_df_to_matrix(midi_df,track=0)  # reshape to desired interval music_matrix <- reshape_piano_roll(all_midi,96*2)  # probabilistic sampling  # create conditional vector conditional_vector <- rep(0,dim(music_matrix)[2]) conditional_vector <- music_matrix[1,] dot_products <- conditional_vector %*% t(music_matrix) positive_similarity <- which(dot_products > 0)   feature_probs <- get_feature_probs(midi_matrix = music_matrix[positive_similarity,])  mean_note_density <- get_mean_note_density(midi_matrix = music_matrix[positive_similarity,])  new_features <- new_features_from_probs(probs = feature_probs,                                         density = mean_note_density,                                         examples = 1) # loop new_feature_vectors <- new_features  for(i in 1:100) {   # put second half into conditional vector   conditional_vector <- c(new_features[((length(new_features)/2)+1):length(new_features)],                           rep(0,length(new_features)/2))   dot_products <- conditional_vector %*% t(music_matrix)   positive_similarity <- which(dot_products > 0)      if(length(positive_similarity)  < 2){     # sample some random stuff     positive_similarity <- sample(1:dim(music_matrix)[1],25)     print(i)   }         feature_probs <-     get_feature_probs(midi_matrix = music_matrix[positive_similarity, ])      mean_note_density <-     get_mean_note_density(midi_matrix = music_matrix[positive_similarity, ])      new_features <- new_features_from_probs(probs = feature_probs,                                           density = mean_note_density,                                           examples = 1)   new_feature_vectors <- rbind(new_feature_vectors,new_features) }  new_matrix <- feature_vector_to_matrix(vec = new_feature_vectors,                                        num_notes = 128)  # transform back to midi midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 2,                                     note_off_length = 8)  meta_messages_df <- get_midi_meta_df(track_0)  meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 1000000)  split_meta_messages_df <- split_meta_df(meta_messages_df)  new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 100)  #### bounce  # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"endless_canon.mid\")  ######### # bounce to mp3 with fluid synth  track_name <- \"endless_mario_1\"  wav_name <- paste0(track_name,\".wav\") midi_name <- paste0(track_name,\".mid\") mp3_name <- paste0(track_name,\".mp3\")  # synthesize midi file to wav with fluid synth system_command <- glue::glue('fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/nintendo_soundfont.sf2 {midi_name}') system(system_command)  # convert wav to mp3 av::av_audio_convert(wav_name,mp3_name)  # clean up and delete wav if(file.exists(wav_name)){   file.remove(wav_name) }"},{"path":"https://crumplab.com/midiblender/articles/composition_tests.html","id":"try-canon-in-d-with-blending","dir":"Articles","previous_headings":"","what":"try canon in D with blending","title":"composition_tests","text":"","code":"library(midiblender) #import midi mario <- midi_to_object(\"canon.mid\") list2env(mario, .GlobalEnv) # send objects to global environment track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  # convert to a piano roll matrix all_midi <- midi_df_to_matrix(midi_df,track=0)  # reshape to desired interval music_matrix <- reshape_piano_roll(all_midi,96*2) probabilistic_matrix <- music_matrix  # probabilistic sampling and blending  for( i in 1: dim(music_matrix)[1]){    conditional_vector <- music_matrix[i,]   dot_products <- conditional_vector %*% t(music_matrix)   positive_similarity <- which(dot_products > 0)      if(length(positive_similarity)  < 2){     # sample some random stuff     positive_similarity <- sample(1:dim(music_matrix)[1],25)     print(i)   }         feature_probs <- get_feature_probs(midi_matrix = music_matrix[positive_similarity,])      mean_note_density <- get_mean_note_density(midi_matrix = music_matrix[positive_similarity,])      new_features <- new_features_from_probs(probs = feature_probs,                                           density = mean_note_density,                                           examples = 1)   probabilistic_matrix[i,] <- new_features }  ## blend blend_matrix <- music_matrix for(i in 1:dim(music_matrix)[1]){   sample_ids <- sample(1:dim(music_matrix)[2])     first_half <- round(length(sample_ids)/2)   blend_vector <- rep(0,length(sample_ids))   blend_vector[sample_ids[1:first_half]] <- music_matrix[i,sample_ids[1:first_half]]   blend_vector[sample_ids[(first_half+1):length(sample_ids)]] <- probabilistic_matrix[i,sample_ids[(first_half+1):length(sample_ids)]]   blend_matrix[i,] <- blend_vector }    new_matrix <- feature_vector_to_matrix(vec = blend_matrix,                                        num_notes = 128)  # transform back to midi midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 1,                                     note_off_length = 8)  meta_messages_df <- get_midi_meta_df(track_0)  meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 1000000)  split_meta_messages_df <- split_meta_df(meta_messages_df)  new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 100)  #### bounce  # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"endless_canon.mid\")  ######### # bounce to mp3 with fluid synth  track_name <- \"endless_mario_1\"  wav_name <- paste0(track_name,\".wav\") midi_name <- paste0(track_name,\".mid\") mp3_name <- paste0(track_name,\".mp3\")  # synthesize midi file to wav with fluid synth system_command <- glue::glue('fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/nintendo_soundfont.sf2 {midi_name}') system(system_command)  # convert wav to mp3 av::av_audio_convert(wav_name,mp3_name)  # clean up and delete wav if(file.exists(wav_name)){   file.remove(wav_name) }"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"basic-example-probabilistic-mario","dir":"Articles","previous_headings":"","what":"Basic Example: Probabilistic Mario","title":"Mangling with Matrices","text":"example imports MIDI fromthe overworld theme song Super Mario brothers. {midiblender} used represent MIDI file feature vector matrix format. example, one bar music coded matrix 128 rows possible note, 96*4 columns midi time ticks 4 beats 4/4 bar. Note_on messages coded 1s respective positions matrix. approach ignores note_off entirely, notes length end. Every cell given 0. midi file sliced bars (temporal interval), slice converted matrix representation. matrix slice concatenated long feature vector. resulting matrix can used compute note time probabilities. probabilities used generate new sequences, exported midi file. go conceptual detail blog post.","code":""},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"import-midi","dir":"Articles","previous_headings":"Basic Example: Probabilistic Mario","what":"import midi","title":"Mangling with Matrices","text":"","code":"mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) # unpack the contents to global environment #> <environment: R_GlobalEnv>"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"transform","dir":"Articles","previous_headings":"Basic Example: Probabilistic Mario","what":"transform","title":"Mangling with Matrices","text":"","code":"# make a copy of the midi_df object containing the desired track track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  # make another copy of midi_df that will be extended with # additional timing information across columns copy_track <- copy_and_extend_midi_df(midi_df = midi_df,                                       track_num = 0)  # Create a new tibble to keep track of some musical intervals metric_tibble <- make_metric_tibble(   copy_track,   bars = 48,   smallest_tick = 8,   ticks_per_beat = 96 )  # add the timing info to the copy copy_track <- add_bars_to_copy_df(copy_track, metric_tibble)  # convert the df to matrix representation music_matrix <- create_midi_matrix(   df = copy_track,   num_notes = 128,   intervals_per_bar = 48,   separate = TRUE )"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"probability","dir":"Articles","previous_headings":"Basic Example: Probabilistic Mario","what":"probability","title":"Mangling with Matrices","text":"section calculates probabilities matrix representation generates new sequences based probabilities.","code":"# get the probability of each note in time # from the whole matrix feature_probs <- get_feature_probs(midi_matrix = music_matrix$pitch_by_time_matrix)  # calculate the average number of notes per row in the matrix # useful to set the density parameter next mean_note_density <- get_mean_note_density(midi_matrix = music_matrix$pitch_by_time_matrix)  # generate new sequences from the probability vector # basically a wrapper to rbinom() new_features <- new_features_from_probs(probs = feature_probs,                                         density = mean_note_density,                                         examples = 100)  #convert the new sequences to a piano roll style matrix new_matrix <- feature_vector_to_matrix(vec = new_features,                                        num_notes = 128)"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"transform-out","dir":"Articles","previous_headings":"Basic Example: Probabilistic Mario","what":"transform out","title":"Mangling with Matrices","text":"next steps involve converting matrix representation back midi dataframe.","code":"# convert the matrix into a dataframe midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 8,                                     note_off_length = 32)  # grab the meta messages from this copy meta_messages_df <- get_midi_meta_df(track_0)  # set the tempo message (it was missing in this case) meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 500000)  # split the meta messages into top and end split_meta_messages_df <- split_meta_df(meta_messages_df)  # compile the valid MIDI dataframe new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 64)  # update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"prob_mario.mid\")"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"export-to-mp3","dir":"Articles","previous_headings":"Basic Example: Probabilistic Mario","what":"export to mp3","title":"Mangling with Matrices","text":"use script like bounce midi file mp3 fluidsynth nintendo sound font.","code":"######### # bounce to mp3 with fluid synth  track_name <- \"prob_mario\"  wav_name <- paste0(track_name,\".wav\") midi_name <- paste0(track_name,\".mid\") mp3_name <- paste0(track_name,\".mp3\")  # synthesize midi file to wav with fluid synth system_command <- glue::glue('fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/nintendo_soundfont.sf2 {midi_name}') system(system_command)  # convert wav to mp3 av::av_audio_convert(wav_name,mp3_name)  # clean up and delete wav if(file.exists(wav_name)){   file.remove(wav_name) }"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"matrix-transforms","dir":"Articles","previous_headings":"","what":"Matrix transforms","title":"Mangling with Matrices","text":"handy helper functions getting MIDI matrix.","code":""},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"midi_df_to_matrix","dir":"Articles","previous_headings":"Matrix transforms","what":"midi_df_to_matrix()","title":"Mangling with Matrices","text":"function takes data frame obtained MIDI file converts binary matrix representation, time frames (absolute midi ticks) columns MIDI note numbers (0-127) rows. mario MIDI file lasts total 14113 midi ticks. memory serves, file set 96 ticks per beat. matrix 128 rows possible note, 14113 possible midi time tick. note values time tick represented 1s matrix.","code":"# import midi mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) #> <environment: R_GlobalEnv>  # convert whole track to a big piano roll style matrix piano_roll_matrix <- midi_df_to_matrix(midi_df= midi_df,                                        track = 0 )  dim(piano_roll_matrix) #> [1]   128 14113"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"reshape_piano_roll","dir":"Articles","previous_headings":"Matrix transforms","what":"reshape_piano_roll()","title":"Mangling with Matrices","text":"function reshapes piano_roll matrix matrix concatenated feature vectors time slice. example, splitting matrix slices 2 beats entail slicing matrix every 96*2 = 192 ticks. sliced matrix concatenated single long feature vector, feature vectors placed new matrix. convenient way quickly reshape matrix purpose calculating note time probabilities new shape, like : Different shapes yield different probabilities, different “musical” results later sequences generated probabilities.","code":"two_beats_matrix <- reshape_piano_roll(piano_roll_matrix,                                        ticks_per_interval = (96*2)) feature_probs <- colSums(two_beats_matrix)/sum(two_beats_matrix)"},{"path":"https://crumplab.com/midiblender/articles/mangling_with_matrices.html","id":"other-examples","dir":"Articles","previous_headings":"","what":"Other examples","title":"Mangling with Matrices","text":"foreseeable future ’m inclined keep posting new examples experiments MIDI mangling music blog. Given fluid state code, ’m sure reproducible examples later , perhaps better keep exploratory stuff . Systematically randomizing Super Mario brothers R Midi matrix representation probabilistic super mario music R MIDI analysis, bags notes, probabilistic generation WIP: Endless probabilistically generated mario music midiblender Midi blending Canon D probabilistically code base becomes solid, ’ll attempt document interesting examples vignettes.","code":""},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"import-midi","dir":"Articles","previous_headings":"","what":"import midi","title":"scratchpad","text":"","code":"mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) #> <environment: R_GlobalEnv>"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"transform","dir":"Articles","previous_headings":"","what":"transform","title":"scratchpad","text":"","code":"track_0 <- copy_midi_df_track(midi_df = midi_df,track_num = 0)  copy_track <- copy_and_extend_midi_df(midi_df = midi_df,                                       track_num = 0)  metric_tibble <- make_metric_tibble(   copy_track,   bars = 48,   smallest_tick = 8,   ticks_per_beat = 96 )  copy_track <- add_bars_to_copy_df(copy_track, metric_tibble)  music_matrix <- create_midi_matrix(   df = copy_track,   num_notes = 128,   intervals_per_bar = 48,   separate = TRUE )"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"probability","dir":"Articles","previous_headings":"","what":"probability","title":"scratchpad","text":"","code":"feature_probs <- get_feature_probs(midi_matrix = music_matrix$pitch_by_time_matrix)  mean_note_density <- get_mean_note_density(midi_matrix = music_matrix$pitch_by_time_matrix)  new_features <- new_features_from_probs(probs = feature_probs,                                         density = mean_note_density,                                         examples = 1)  new_matrix <- feature_vector_to_matrix(vec = new_features,                                        num_notes = 128)"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"transform-out","dir":"Articles","previous_headings":"","what":"transform out","title":"scratchpad","text":"","code":"midi_time_df <- matrix_to_midi_time(midi_matrix = new_matrix,                                     smallest_time_unit = 8,                                     note_off_length = 32)  meta_messages_df <- get_midi_meta_df(track_0)  meta_messages_df <- set_midi_tempo_meta(meta_messages_df,update_tempo = 500000)  split_meta_messages_df <- split_meta_df(meta_messages_df)  new_midi_df <- matrix_to_midi_track(midi_time_df = midi_time_df,                                     split_meta_list = split_meta_messages_df,                                     channel = 0,                                     velocity = 64)"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"export","dir":"Articles","previous_headings":"","what":"export","title":"scratchpad","text":"keeping script now.","code":"# update miditapyr df miditapyr_object$midi_frame_unnested$update_unnested_mf(new_midi_df)  #write midi file to disk miditapyr_object$write_file(\"try_write.mid\")  ######### # bounce to mp3 with fluid synth  track_name <- \"heart_soul_A\"  wav_name <- paste0(track_name,\".wav\") midi_name <- paste0(track_name,\".mid\") mp3_name <- paste0(track_name,\".mp3\")  # synthesize midi file to wav with fluid synth system_command <- glue::glue('fluidsynth -F {wav_name} ~/Library/Audio/Sounds/Banks/nintendo_soundfont.sf2 {midi_name}') system(system_command)  # convert wav to mp3 av::av_audio_convert(wav_name,mp3_name)  # clean up and delete wav if(file.exists(wav_name)){   file.remove(wav_name) }"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"midi_to_matrix","dir":"Articles","previous_headings":"","what":"midi_to_matrix","title":"scratchpad","text":"Haven’t turned function yet. Fairly straightforward way convert whole midi file single matrix (like piano roll).","code":"mario <- midi_to_object(\"all_overworld.mid\") list2env(mario, .GlobalEnv) #> <environment: R_GlobalEnv>  all_midi <- midi_df_to_matrix(midi_df,track=0)"},{"path":"https://crumplab.com/midiblender/articles/scratchpad.html","id":"reshape-a-piano-roll-matrix","dir":"Articles","previous_headings":"","what":"reshape a piano roll matrix","title":"scratchpad","text":"","code":"new_shape <- reshape_piano_roll(all_midi,48)"},{"path":"https://crumplab.com/midiblender/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew J. C. Crump. Author, maintainer.","code":""},{"path":"https://crumplab.com/midiblender/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Crump MJC (2024). “midiblender: Experiments genRative MIDI mangling.”","code":"@Misc{,   title = {midiblender: Experiments in genRative MIDI mangling},   author = {Matthew J. C. Crump},   year = {2024}, }"},{"path":"https://crumplab.com/midiblender/index.html","id":"midiblender-","dir":"","previous_headings":"","what":"midiblender: Experiments in genRative MIDI mangling","title":"midiblender: Experiments in genRative MIDI mangling","text":"goal midiblender mangle midi files R listen happens. experimental, use frustration package. ’m writing use cases, using R package format helps clarify track goals ’m chasing . R package, perhaps confused one. ’m sharing fun case others find useful.","code":""},{"path":"https://crumplab.com/midiblender/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"midiblender: Experiments in genRative MIDI mangling","text":"can install midiblender like : Aspects package rely pyramidi, also experimental lifecycle. package wraps python libraries (miditapyr mido) handle midi import export. See pyramidi documentation information necessary install work.","code":"## install remotes package if it's not already if (!requireNamespace(\"remotes\", quietly = TRUE)) {   install.packages(\"remotes\") }  ## install dev version of rtweettree from github remotes::install_github(\"CrumpLab/midiblender\")"},{"path":"https://crumplab.com/midiblender/index.html","id":"to-do","dir":"","previous_headings":"","what":"To Do","title":"midiblender: Experiments in genRative MIDI mangling","text":"conceptual getting started document [] Attempting minimally document functions added [] Using vignettes conduct various tests concepts midi blending [] Fill example code function documentation primary style development trying things fun listening …side eye toward posterity case mangling pattern seems like tool ’d want use .","code":""},{"path":"https://crumplab.com/midiblender/index.html","id":"thanks-to","dir":"","previous_headings":"","what":"Thanks to","title":"midiblender: Experiments in genRative MIDI mangling","text":"Thanks R community building wonderful tools. Special thanks Urs Wilke pyramidi, helped get speed quickly.","code":""},{"path":[]},{"path":"https://crumplab.com/midiblender/reference/add_bars_to_copy_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","title":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","text":"function modifies copy dataframe df adding new columns related time markers bars metric_tibble. Rows dataframe iterated upon set values new columns based matching time_steps metric_tibble.","code":""},{"path":"https://crumplab.com/midiblender/reference/add_bars_to_copy_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","text":"","code":"add_bars_to_copy_df(df, metric_tibble)"},{"path":"https://crumplab.com/midiblender/reference/add_bars_to_copy_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","text":"df data frame needs additional time marker bar related data. columns data frame can vary, must contain 'total_time' column. Usually received copy_and_extend_midi_df(). metric_tibble tibble columns 'time_steps', 'bars', 'bar_steps'. tibble provides metrics used add new marker bar data data frame df. Created make_metric_tibble().","code":""},{"path":"https://crumplab.com/midiblender/reference/add_bars_to_copy_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","text":"data frame copy input data frame df, three additional columns: 'time_markers', 'bars', 'bar_steps'. 'time_markers' populated index match 'total_time' df 'time_steps' metric_tibble. bars' 'bar_steps' populated corresponding values metric_tibble based matching 'time_steps'.","code":""},{"path":"https://crumplab.com/midiblender/reference/add_bars_to_copy_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Bars to Copy of Dataframe — add_bars_to_copy_df","text":"","code":"if (FALSE) { copy_track <- copy_and_extend_midi_df(midi_df, track_num = 0) metric_tibble <- make_metric_tibble(copy_track, ticks_per_beat = 96, bars=48,smallest_tick=8) copy_track <- add_bars_to_copy_df(copy_track,metric_tibble) }"},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":null,"dir":"Reference","previous_headings":"","what":"copy_and_extend_midi_df — copy_and_extend_midi_df","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"Copy midi_df, add cumulative time column, keep note_on messages","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"","code":"copy_and_extend_midi_df(midi_df, track_num = 0)"},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"midi_df dataframe representing midi file returned midi_to_object(). dataframe must contain columns named 'i_track', 'type', 'time', 'i_track' track number, 'type' indicates type event (e.g., \"note_on\" \"note_off\"), 'time' time point event. track_num integer indicating track number processed. Default 0.","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"modified dataframe additional 'total_time' column filtered \"note_on\" type.","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"function filters modifies input midi dataframe. first filters data keep rows specified track_num \"note_on\" \"note_off\". adds total_time column accumulates time variable. Lastly, filters return \"note_on\" rows.","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_and_extend_midi_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"copy_and_extend_midi_df — copy_and_extend_midi_df","text":"","code":"if (FALSE) { modified_midi_df = copy_and_extend_midi_df(midi_df, track_num = 0) }"},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":null,"dir":"Reference","previous_headings":"","what":"copy single track df within midi_df — copy_midi_df_track","title":"copy single track df within midi_df — copy_midi_df_track","text":"Copy midi_df, add cumulative time column, keep note_on messages","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"copy single track df within midi_df — copy_midi_df_track","text":"","code":"copy_midi_df_track(midi_df, track_num = 0)"},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"copy single track df within midi_df — copy_midi_df_track","text":"midi_df dataframe representing midi file returned midi_to_object(). track_num integer indicating track number select. Default 0.","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"copy single track df within midi_df — copy_midi_df_track","text":"filtered data frame containing messages selected track","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"copy single track df within midi_df — copy_midi_df_track","text":"function filters midi_df specific track","code":""},{"path":"https://crumplab.com/midiblender/reference/copy_midi_df_track.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"copy single track df within midi_df — copy_midi_df_track","text":"","code":"if (FALSE) { copy_track_0 = copy_midi_df_track(midi_df, track_num = 0) }"},{"path":"https://crumplab.com/midiblender/reference/create_midi_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"create_midi_matrix function — create_midi_matrix","title":"create_midi_matrix function — create_midi_matrix","text":"function creates MIDI matrix given musical score.","code":""},{"path":"https://crumplab.com/midiblender/reference/create_midi_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create_midi_matrix function — create_midi_matrix","text":"","code":"create_midi_matrix(   df,   num_notes = 128,   intervals_per_bar = 48,   separate = FALSE )"},{"path":"https://crumplab.com/midiblender/reference/create_midi_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create_midi_matrix function — create_midi_matrix","text":"df data.frame containing input MIDI notation. df least columns named 'bars', 'note', 'bar_steps'. 'bars' indicates bar note occurs , note' indicates pitch note, bar_steps' shows time position within bar note occurs. num_notes integer determining size MIDI note bins. Default 128. intervals_per_bar integer specifying number intervals split bar matrix preparation. Default 48, corresponds 48th notes (every quarter beat 4/4 signature). separate logical value indicating function return single concatenated matrix (FALSE) list separate pitch, time, pitch time matrices (TRUE). Default FALSE.","code":""},{"path":"https://crumplab.com/midiblender/reference/create_midi_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create_midi_matrix function — create_midi_matrix","text":"separate = FALSE, matrix MIDI note data rows representing bars, columns representing 1) counts notes pitch bins, 2) counts notes time bins, 3) matrix 'flattened' vector pitch time data. separate = TRUE, list containing separate matrices pitch, time, pitch time.","code":""},{"path":"https://crumplab.com/midiblender/reference/create_midi_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"create_midi_matrix function — create_midi_matrix","text":"","code":"if (FALSE) { copy_track <- copy_and_extend_midi_df(midi_df, track_num = 0) metric_tibble <- make_metric_tibble(copy_track, ticks_per_beat = 96, bars=48,smallest_tick=8) copy_track <- add_bars_to_copy_df(copy_track,metric_tibble) music_matrix <- create_midi_matrix(copy_track,128,48) }"},{"path":"https://crumplab.com/midiblender/reference/feature_vector_to_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert feature vector to matrix — feature_vector_to_matrix","title":"Convert feature vector to matrix — feature_vector_to_matrix","text":"function takes feature vector number notes, returns matrix. note row matrix.","code":""},{"path":"https://crumplab.com/midiblender/reference/feature_vector_to_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert feature vector to matrix — feature_vector_to_matrix","text":"","code":"feature_vector_to_matrix(vec, num_notes)"},{"path":"https://crumplab.com/midiblender/reference/feature_vector_to_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert feature vector to matrix — feature_vector_to_matrix","text":"vec vector features. length vector must divisible number notes. num_notes integer specifying number notes. number rows returned matrix.","code":""},{"path":"https://crumplab.com/midiblender/reference/feature_vector_to_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert feature vector to matrix — feature_vector_to_matrix","text":"matrix num_notes rows length(vec)/num_notes columns.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_feature_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Feature Probabilities — get_feature_probs","title":"Get Feature Probabilities — get_feature_probs","text":"function calculates probability feature proportion total. sums values MIDI matrix, calculates summary column(feature), finally computes probability feature dividing column summary total summary.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_feature_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Feature Probabilities — get_feature_probs","text":"","code":"get_feature_probs(midi_matrix)"},{"path":"https://crumplab.com/midiblender/reference/get_feature_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Feature Probabilities — get_feature_probs","text":"midi_matrix numeric note time feature matrix.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_feature_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Feature Probabilities — get_feature_probs","text":"numeric vector containing probabilities feature. length vector equal number features (columns) input MIDI matrix.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_feature_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Feature Probabilities — get_feature_probs","text":"","code":"if (FALSE) { }"},{"path":"https://crumplab.com/midiblender/reference/get_mean_note_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the mean note density of a midi matrix — get_mean_note_density","title":"Compute the mean note density of a midi matrix — get_mean_note_density","text":"function takes midi matrix returns rounded mean sum rows. Note round function used round nearest whole number.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_mean_note_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the mean note density of a midi matrix — get_mean_note_density","text":"","code":"get_mean_note_density(midi_matrix)"},{"path":"https://crumplab.com/midiblender/reference/get_mean_note_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the mean note density of a midi matrix — get_mean_note_density","text":"midi_matrix numerical matrix rows represents MIDI notes, sum row represents note density.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_mean_note_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the mean note density of a midi matrix — get_mean_note_density","text":"rounded integer represents mean note density.","code":""},{"path":"https://crumplab.com/midiblender/reference/get_midi_meta_df.html","id":null,"dir":"Reference","previous_headings":"","what":"get meta messages from a track_df — get_midi_meta_df","title":"get meta messages from a track_df — get_midi_meta_df","text":"get meta messages track_df","code":""},{"path":"https://crumplab.com/midiblender/reference/get_midi_meta_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get meta messages from a track_df — get_midi_meta_df","text":"","code":"get_midi_meta_df(track_df)"},{"path":"https://crumplab.com/midiblender/reference/get_midi_meta_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get meta messages from a track_df — get_midi_meta_df","text":"track_df filtered midi_df selected i_track","code":""},{"path":"https://crumplab.com/midiblender/reference/get_midi_meta_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get meta messages from a track_df — get_midi_meta_df","text":"tibble meta messages","code":""},{"path":"https://crumplab.com/midiblender/reference/make_metric_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","title":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","text":"function computes dataframe contains timestamp (beats, unit), bar number, step within bar corresponding timestamp given specific parameters ticks_per_beat (many ticks (time-resolution steps) per beat ), smallest_tick (determines resolution output), total number bars.","code":""},{"path":"https://crumplab.com/midiblender/reference/make_metric_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","text":"","code":"make_metric_tibble(df, ticks_per_beat, bars = NULL, smallest_tick = NULL)"},{"path":"https://crumplab.com/midiblender/reference/make_metric_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","text":"df dataframe containing least 'time' column 'total_time' column. Usually df copy_and_extend_midi_df() ticks_per_beat Integer specifying number ticks per beat bars Integer specifying number bars. parameter NULL, compute assuming 4/4 meter. Default NULL. smallest_tick Numeric. smallest unit time (beats) represented output dataframe. NULL, compute smallest observed unit 'time' column. Default NULL.","code":""},{"path":"https://crumplab.com/midiblender/reference/make_metric_tibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","text":"dataframe row represents one 'tick' (.e., fundamental temporal unit), columns represent 'tick' timestamp (time_steps), corresponding bar number (bars), step within bar (bar_steps).","code":""},{"path":"https://crumplab.com/midiblender/reference/make_metric_tibble.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a tibble (dataframe) defining musical metrics — make_metric_tibble","text":"","code":"if (FALSE) { copy_track <- copy_and_extend_midi_df(midi_df, track_num = 0) metric_tibble <- make_metric_tibble(copy_track, ticks_per_beat = 96, bars=48,smallest_tick=8)  }"},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","title":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","text":"function reads binary matrix pitch classes rows temporal locations columns (1s represent note onsets, 0s represent absences notes). converts binary representation MIDI timings, .e. time (ticks) note onsets note offsets.","code":""},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","text":"","code":"matrix_to_midi_time(midi_matrix, smallest_time_unit = 8, note_off_length = 32)"},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","text":"midi_matrix binary matrix, pitch classes rows temporal location columns. cell value either 1 (note onset) 0 (notes absence). smallest_time_unit Integer, specifying smallest time unit (MIDI ticks) used binary matrix representation. Default 8 ticks. note_off_length Numeric, specifying fixed note duration MIDI ticks used notes sequence. Default 32 ticks.","code":""},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","text":"dataframe four columns: note_num, note_id, type, time. note_num MIDI pitch note. note_id unique identifier note. type whether event note onset (\"note_on\") note offset (\"note_off\"). time time (MIDI ticks) since last event.","code":""},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a matrix representation of a MIDI sequence back to MIDI timings — matrix_to_midi_time","text":"","code":"if (FALSE) { }"},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_track.html","id":null,"dir":"Reference","previous_headings":"","what":"matrix_to_midi_track function — matrix_to_midi_track","title":"matrix_to_midi_track function — matrix_to_midi_track","text":"function converts MIDI time dataframe MIDI track dataframe, given specific channel velocity. subsequently writes note /, time, note number messages.","code":""},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_track.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"matrix_to_midi_track function — matrix_to_midi_track","text":"","code":"matrix_to_midi_track(midi_time_df, split_meta_list, channel = 0, velocity = 64)"},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_track.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"matrix_to_midi_track function — matrix_to_midi_track","text":"midi_time_df dataframe containing MIDI time information. split_meta_list list two data frames, first contains metadata start MIDI track second contains metadata end MIDI track. channel Integer value representing MIDI channel. Default 0. velocity Integer value representing velocity MIDI notes. Default 64.","code":""},{"path":"https://crumplab.com/midiblender/reference/matrix_to_midi_track.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"matrix_to_midi_track function — matrix_to_midi_track","text":"updated MIDI track data frame includes note /, time, note number messages.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_df_to_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","title":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","text":"function takes data frame obtained MIDI file converts binary matrix representation, time frames columns MIDI note numbers (0-127) rows.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_df_to_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","text":"","code":"midi_df_to_matrix(midi_df, track = 0)"},{"path":"https://crumplab.com/midiblender/reference/midi_df_to_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","text":"midi_df data frame MIDI events, midi_to_object() track track number converted matrix. Default 0.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_df_to_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","text":"binary matrix column indices represent time frames row indices represent MIDI note numbers. entry matrix 1 corresponding note corresponding time, 0 otherwise.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_df_to_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert MIDI Data Frame to piano roll Matrix — midi_df_to_matrix","text":"","code":"if (FALSE) { }"},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":null,"dir":"Reference","previous_headings":"","what":"midi_to_object Function — midi_to_object","title":"midi_to_object Function — midi_to_object","text":"Import MIDI data transform several useful R objects.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"midi_to_object Function — midi_to_object","text":"","code":"midi_to_object(file_path)"},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"midi_to_object Function — midi_to_object","text":"file_path character string specifying path MIDI file.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"midi_to_object Function — midi_to_object","text":"list MIDI import objects, includes: miditapyr_object: miditapyr object representing complete MIDI file. mido_object: mido object representing MIDI file. message_list_df: data frame MIDI messages. ticks_per_beat: number ticks per beat. midi_df: data frame MIDI messages, fully unnested.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"midi_to_object Function — midi_to_object","text":"mostly wraps pyramidi functions call miditapyr mido.","code":""},{"path":"https://crumplab.com/midiblender/reference/midi_to_object.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"midi_to_object Function — midi_to_object","text":"","code":"if (FALSE) {   midi_objects <- midi_to_object(\"path_to_your_midi_file.midi\")   list2env(midi_objects, .GlobalEnv) # add to global environment }"},{"path":"https://crumplab.com/midiblender/reference/new_features_from_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Create New Features Based on Probabilities — new_features_from_probs","title":"Create New Features Based on Probabilities — new_features_from_probs","text":"Input sequence probabilities get back new sequence based binomial distribution probabilities. resulting value greater 1 new sequence set 1.","code":""},{"path":"https://crumplab.com/midiblender/reference/new_features_from_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create New Features Based on Probabilities — new_features_from_probs","text":"","code":"new_features_from_probs(probs, density = 6, examples = 1)"},{"path":"https://crumplab.com/midiblender/reference/new_features_from_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create New Features Based on Probabilities — new_features_from_probs","text":"probs Numeric vector, sequence probabilities 0 1 used generate new sequence. density Integer, number trials (default 6). exmaples Inger, number examples generate (default 1)","code":""},{"path":"https://crumplab.com/midiblender/reference/new_features_from_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create New Features Based on Probabilities — new_features_from_probs","text":"example 1, sequence length probs values following binomial distribution based inputted probabilities, values greater 1 set 1. example > 1, matrix sequences, number columns length probabilities, sequences corresponding rows.","code":""},{"path":"https://crumplab.com/midiblender/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://crumplab.com/midiblender/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://crumplab.com/midiblender/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://crumplab.com/midiblender/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://crumplab.com/midiblender/reference/reshape_piano_roll.html","id":null,"dir":"Reference","previous_headings":"","what":"Reshape Piano Roll Matrix — reshape_piano_roll","title":"Reshape Piano Roll Matrix — reshape_piano_roll","text":"function reshapes piano roll matrix specified interval length. pads zero crops piano roll matrix fit desired length.","code":""},{"path":"https://crumplab.com/midiblender/reference/reshape_piano_roll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reshape Piano Roll Matrix — reshape_piano_roll","text":"","code":"reshape_piano_roll(piano_roll_matrix, ticks_per_interval)"},{"path":"https://crumplab.com/midiblender/reference/reshape_piano_roll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reshape Piano Roll Matrix — reshape_piano_roll","text":"piano_roll_matrix matrix reshaped. matrix rows represent pitch (0 127) columns represents time (ticks). ticks_per_interval number specifies number ticks per interval.","code":""},{"path":"https://crumplab.com/midiblender/reference/reshape_piano_roll.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reshape Piano Roll Matrix — reshape_piano_roll","text":"reshaped matrix num_intervals rows (ticks_per_interval*128) columns. Rows represent time interval columns represents pitch.","code":""},{"path":"https://crumplab.com/midiblender/reference/reshape_piano_roll.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reshape Piano Roll Matrix — reshape_piano_roll","text":"","code":"if (FALSE) { }"},{"path":"https://crumplab.com/midiblender/reference/set_midi_tempo_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"set midi tempo in meta messages — set_midi_tempo_meta","title":"set midi tempo in meta messages — set_midi_tempo_meta","text":"set midi tempo meta messages","code":""},{"path":"https://crumplab.com/midiblender/reference/set_midi_tempo_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set midi tempo in meta messages — set_midi_tempo_meta","text":"","code":"set_midi_tempo_meta(meta_messages_df, update_tempo = 5e+05)"},{"path":"https://crumplab.com/midiblender/reference/set_midi_tempo_meta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set midi tempo in meta messages — set_midi_tempo_meta","text":"meta_messages_df df meta messages update_tempo Integer, midi tempo update","code":""},{"path":"https://crumplab.com/midiblender/reference/set_midi_tempo_meta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"set midi tempo in meta messages — set_midi_tempo_meta","text":"updated meta_messages_df","code":""},{"path":"https://crumplab.com/midiblender/reference/split_meta_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Split a meta_df into list of top and end messages — split_meta_df","title":"Split a meta_df into list of top and end messages — split_meta_df","text":"Split meta_df list top end messages","code":""},{"path":"https://crumplab.com/midiblender/reference/split_meta_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split a meta_df into list of top and end messages — split_meta_df","text":"","code":"split_meta_df(meta_messages_df)"},{"path":"https://crumplab.com/midiblender/reference/split_meta_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split a meta_df into list of top and end messages — split_meta_df","text":"meta_messages_df meta_messages_df split","code":""},{"path":"https://crumplab.com/midiblender/reference/split_meta_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split a meta_df into list of top and end messages — split_meta_df","text":"list two tibbles","code":""}]
